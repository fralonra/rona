---
title: "Reparing partition with input/output error"
date: 2020-02-25T17:07:44+08:00
author: "Fralonra"
cover: ""
tags: ["linux"]
keywords: ["linux", "file system"]
description: "Reparing partition with input/output error."
showFullContent: false
---

After an unclean shutdown, my `home` partition failed again. Unfortunately, using alternate superblocks didn't help, all of them gave me the following error in the end of the output generated by `e2fsck`:
```
Error writing block 1 (input/output error).  Ignore error?
```

I ran `smartctl -a /dev/xxx`, and found this:
```
# 2  Extended offline    Completed: read failure       00%     13771         6960152
```
A serious problem might had happened. So I did the following:
1. Using `ddrescue` to copy the whole partition to an image. I started to work on that backup to avoid doing more damage to the original device.
1. Making a loop device using `losetup`. Besides, an [overlay file](https://raid.wiki.kernel.org/index.php/Recovering_a_failed_software_RAID#Making_the_harddisks_read-only_using_an_overlay_file) is a much safer option.
1. Trying out methods to fix the issue. I tried `e2fsck` and it worked for me, without any input/output error.

After doing three steps above, the only thing I need to do is copying the fixed image back to the partition. Hurray!

Moral of this story: keep in mind to backup the valuable data all the time.